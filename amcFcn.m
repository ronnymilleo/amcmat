function [y1] = amcFcn(x1)
%AMCFCN neural network simulation function.
%
% Auto-generated by MATLAB, 16-Nov-2019 22:18:45.
% 
% [y1] = amcFcn(x1) takes these arguments:
%   x = 10xQ matrix, input #1
% and returns:
%   y = 6xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.277167679402306;1.56855237748722;0.0280899828485262;0.0721451589666865;2.28376242875727;0.118877448606683;0.0149912797060469;0.0736887067242483;0.122440749824389;0.0316227766016838];
x1_step1.gain = [1.5458095678955;3.51200856295326;9.01142259601751;6.87399535174668;0.730878076070715;0.00747090485273347;3.3188901382169;4.87482295727685;3.01417257112072;0.063308862065433];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.874021463124490916;-1.6172444198157847062;0.93246538158877800839;0.5494484619577577611;-0.33921070937471170526;-0.33397621165688951006;-0.66900496247195839761;-1.0551429243084708975;-1.4628075103457458539;1.241734602140723176];
IW1_1 = [0.24909828081043614012 0.08021909490378502372 -0.38539549959170638083 -0.85131255123061189138 1.088924046591099204 -0.30670752514217053397 -1.3863664731873546199 -0.06154422313956991325 -1.4137890733481879302 0.19391279060474997387;1.8517819006422111539 -0.68046961378591774849 0.1175347819432789459 4.1471397798785512023 0.27186266900134281599 0.72209550062634753065 1.4477526577402348718 1.4262035145223890265 1.4735174134710946614 0.27087109648265572659;-6.7708573123923381232 0.33944756410154230952 1.5748775079812094013 0.74239594729215629965 0.097190626175495412054 -0.27753865491296214607 -0.24904248235410827994 0.14565975534569247651 0.39785802949199194911 1.749489678542074822;0.51370951712563350799 0.52430856017252736034 -0.61727070289715824103 -3.6636684864163351349 -0.44956212778896087467 -0.18025140465674674428 0.96664378221357105669 1.0037102251407785669 0.69897033381124107354 1.5148815286286005932;10.735318975891301463 0.16813267543399182391 -0.53248760766963587621 -0.18997052687153745398 -0.11927765731690351259 -0.094488818249720760156 -0.65840354326625394332 -0.6077140351227110493 0.063681851084431487231 -1.2861285842535772339;-7.1878750898910270806 -0.89223229993080832578 -2.230090967105292421 -1.0844406417399390374 -0.018736850713942907604 0.076938103036028326898 0.52646983173114547672 0.64695573740503697913 0.0020633781160243089108 -0.78228576749527423129;-0.42779817020243054992 1.7745793501235682665 -1.0402048095271119177 -0.4445106702151841449 0.14447541204761613076 -0.35673313463869682494 0.51564711253475770114 0.65224505774419228032 -0.54290928059849530296 -0.99585459406744569755;-0.01862471826718719789 0.85145996665700751649 -3.1620612077316279098 2.3493429278702895324 -0.3836947079929683424 0.30055946697847701898 -1.4111961846157687894 -1.1479582218138406624 -2.6516711642499406487 -0.39771215182367264385;-0.97321205075886629832 0.24327340917664683206 0.29446718146689293549 -0.2460724549390249094 0.82989866641945508885 0.54633336455704273327 -0.38661127369991643565 0.50616202515102082238 0.46087352731213232504 0.67954630081089484328;-0.087892974397849529811 0.72784628535570816688 -2.0220714153621823783 -1.371164428271729685 -0.13552891776830769399 -1.3378968250709344368 -1.2659066911431535729 -0.66317035424565107249 -0.30717837885306298329 1.3243142793241229338];

% Layer 2
b2 = [-1.414681571744287325;-1.4287850004889190991;0.11876623251872601983;-0.76919343318629229689;0.19190151161917429201;0.3554456745751612412;-0.14934360616625005913;2.0824057481966122829];
LW2_1 = [-0.25305800300266839686 -0.68604582735600572185 0.12029281833217279896 0.032295392751358203975 1.2340922089230212944 -0.39470961097447315735 -1.7066576704706586387 1.1485932377249177261 0.28518083230725993493 1.8422634501583923239;1.0795730035544137682 -0.17520547084936691218 -2.1865838900917329291 -0.96613682524980737387 0.78065050854582473949 -0.13168151023478216755 0.15654479458398423697 -1.2537576538527479553 0.25088127441476520962 0.79908098071970889986;0.045771086562345270066 0.8832437301796980389 -2.6082964919436535389 0.95271399391041733384 3.8736526666509956129 0.0092310833586985215765 -0.26843159822549111926 -0.88265288723428025897 0.22517683010380856734 -1.1522349433386438466;1.5768916751544157506 -0.99404189906150075551 4.7078005007389069903 0.37777007025071679402 4.8353111051985591118 3.0728927169541395692 0.38887302475239643451 0.65940489918722255958 0.56331706743568499274 -1.0012357444999460121;-0.46530537965335433404 2.9043119806511592529 -0.24100821491265034258 -1.6078339256909708332 -1.8624251298905891705 -2.8712185278715725012 -0.68389672589284467019 1.3138059189291324547 -1.2436132916408895177 -0.37387469385633675945;1.2454826692343021755 1.1382368259028687874 -1.15859027093931366 -3.4469142842053281939 -1.0137006822443728193 3.052232152975478563 0.0024377400099365904851 3.6653545658544062213 1.0519601993315681465 2.0069568696579929146;-1.7175646103489081717 -1.9918924634402837004 0.41828828172143600606 1.5081510634690962203 -3.8729250862392037291 -1.8195915744489024046 -1.7925443690634568217 -0.53255438425757739562 -0.63183352511205503887 0.99085066621847739388;-0.30517238269246721449 -0.73954767635999996145 0.021564419888264359237 -0.70414835032543576787 -0.28453704958956227422 0.031438386230516111863 0.54005986793358096154 -0.68517917347379331261 0.07387312537717038996 0.74179362400259396537];

% Layer 3
b3 = [2.6291504578633650979;-1.1838646314574088336;1.4646379012923824714;-0.14193362304715417821;-1.5940949158722981238;0.42725563423782864092];
LW3_2 = [-0.42591596169530820948 -1.0366700094721625902 0.12464854693978591471 -2.2216431432865428874 1.9290819209137575196 2.78311999397774823 -1.1738302818258163907 2.0117870583603023604;0.62805442641004360915 -1.1636211041944624078 -0.8254428889340955644 1.0073851101242410344 6.1665286038056281726 3.236179972032037 -2.5478187488733561317 -0.95705484783810157445;-1.1161335280629260946 1.3210078918835683748 -2.5144786458229893 -6.8379290851254648231 0.055977004404136214422 1.5301784924866650428 1.7242021338363615612 1.293079353029574774;-1.884038265870227491 0.53456584663546824476 1.727526040218530845 1.6307172833078082963 -1.9472359775684990879 0.62447432859506135649 -2.6528386100240171075 0.43943479086612696749;-1.6197186071805824703 0.68538648539013258265 -0.43566587673783363499 0.25030701770157659514 1.8424899745583163124 -1.0878852610293359149 0.50125552072976187201 -0.18293825807975369613;0.64985766688993062967 2.4761328474581238979 0.69236866070561198239 2.9218825453405057324 -1.2701995797526570708 4.6190079412096132216 -3.5752326751681575701 -2.0656866180142161582];

% Layer 4
b4 = [-2.0777675012619458705;0.17763710944804800285;1.2503466060932451054;0.50211358310098508362;-0.28074783420310422954;-1.0136453393423665581];
LW4_3 = [-0.67574840759641452426 -4.046947454694287849 5.9519714652926802856 -0.85100091108615238955 -3.1254165247769862823 -1.5496201716852764374;2.1644319384790207117 -3.8086208503913705492 -3.9039896039695092256 0.24465360202383870658 -0.36350854373240137907 3.5394333274188229943;-3.3204288542453150868 -3.395588503437639627 -3.7313065835262162473 0.74965007311907627674 -0.49479112387990659139 -0.71217117532920803935;0.25460125580472664497 7.3667223585696612886 0.23237218918841640036 3.1886140737022508063 -1.3045214301276031321 4.5930224125973015958;0.39312940859923006798 6.6880500431777640813 -0.94916697720577236641 -3.8464165873457134559 -0.089817356077556809169 -4.2317737893307132424;0.41593096727975326088 -1.0071171526704525423 3.5618330071520998281 -0.44795837048801689928 5.9458084964162880581 -1.7581769621092444567];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);

% Layer 4
a4 = softmax_apply(repmat(b4,1,Q) + LW4_3*a3);

% Output 1
y1 = a4;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
