function [y1] = rnaFcn(x1)
%RNAFCN neural network simulation function.
%
% Auto-generated by MATLAB, 13-Sep-2019 16:22:30.
% 
% [y1] = rnaFcn(x1) takes these arguments:
%   x = 9xQ matrix, input #1
% and returns:
%   y = 6xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.287016952728492;1.56279866698493;0.124205262530136;0.138979717616889;2.24133535504666;0.100135890787588;0.0148469994824402;0.0733240248659885;0.121855701883708];
x1_step1.gain = [1.55696919938266;3.52250501205158;7.63528897088677;5.89585747715896;0.566583805551853;0.0284517973326085;3.14714884731488;4.68653215809271;2.91980725044151];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.045064004854891676066;1.5835847043764337272;-4.1938868971076521674;-3.4734318625252185164;-6.8786751789827595971;-1.4710616570448520335;-5.5907253638122549333;1.0999140964996660941;-0.86094715697971258006;4.0472495067430696025;-0.8233559927116859134;2.9450563012597936741;-4.7314374980521529679;-0.9209444361626565323;0.44946001908051663731;5.1082960108446187064;6.1142249010833626954;-0.38085442565769567214;0.64692150282331495337;-0.57676689084908772109];
IW1_1 = [-0.93799932626539206382 -0.76297641698440699098 3.1546268537473909355 0.77513413073328152336 0.43036689349755136158 -0.15229708800308425221 0.26628243263850842615 2.6344204625766987071 -1.7141214281685985821;0.4070525411160385576 -0.29938222759139071494 -0.82670018172895221031 -0.67624857109490910112 -0.16567302366819303128 -0.1742514910590640953 -0.50622219712547611437 -0.019964194065932902578 0.43428215857426344382;-0.48492943292016593704 0.14193723605062211202 -0.078814384122058045445 -0.46084960854732975877 0.050466780704476243979 -0.20398219330614214551 -14.305012109088403705 -0.32456604134725680622 5.1265983758072195542;0.30049054394886270947 -1.7110202278837398637 1.8707318479522636601 1.0234908174370818124 0.14760102240133279872 0.16331678673618965636 -6.1112925211001751791 3.4355873739180764481 11.261125381414787583;-1.556599843588751364 0.73056917514721220197 -1.7726267549282683778 -1.7577509669046249563 -0.0078364878275810744696 -2.021388475253414807 -18.752652128529810227 -2.6190374272124823385 14.098514927239737204;-0.66400298418954262214 -0.14049801392390728894 1.7434808132277899162 -2.2681479577296945749 0.62278837353118454701 0.042134962071663915884 -7.9216220563736525762 -2.1023678919931825249 11.134762242046861047;1.666736166945156139 -1.0529456614783814228 2.040984584121159795 1.6520632002224853174 0.074788475736887502499 2.1691549356040025209 -14.913697098951866238 2.0750628921563945006 23.72152443921967091;-0.67023667122493668646 -2.2356020536745244698 2.0603137464457708106 -1.8838918843362002509 3.1352335979431900093 -1.2667231090314841069 -2.6442846197259473051 -1.2558703796163486199 -5.770030702512700671;0.42538114769564611128 -2.2812440493146319831 -4.8771404058896452582 3.5687325246524759237 0.48540757065765677281 0.91666009426143890693 -1.674267382259921666 0.71542873940379214659 -7.1067843060074658013;-0.87660099582379646943 -1.5618325112075239769 1.0713405216393347974 -1.3495751172648891014 0.37002261281214787747 -0.52937755223107851865 8.2531236528569298372 -1.266174294839233827 -13.143884899556308454;2.4985687584356912616 -3.8802588186484476829 3.3599487174143889412 -3.724316465110380836 5.127823798224616425 -5.1526772158897875542 -0.87150045751576399322 3.8256050258143554643 0.039540439768795232478;-5.1561936411820035175 -0.9537498129364467836 1.2875199422622360945 -0.82621583113127894382 2.2991339676901461075 3.5384218447778437167 -2.225778937765185983 4.0911880101195148285 4.5815407988716359;-0.28658572176915581009 -0.66467822480997729162 1.4692871614948606052 -1.891604344782505942 0.18032668332599907646 0.12899111400814830541 -13.101708927913534808 2.1845751499925589734 19.424895220230169457;3.1469095804132845018 -1.9716205286230377158 -1.3555355075376513962 4.2935558686992738586 1.9365002085802720533 -0.33201430419542937722 -2.0122689853078412625 2.1101371555917038947 -3.8647909559047053385;1.6359431881955102117 -4.1651142290505607235 4.7513669498374664357 -1.1609888191777553157 0.65945910379810124269 1.941037009532057267 -5.8889708064806232102 1.2750832600293753316 5.8557017064809553375;-1.4396110313831622651 -0.81122069769299920416 1.3139675497642162583 -1.8589461826594837479 0.24649420292251222886 -0.4943539376481829728 14.521349759624492037 2.0830309010593959229 -11.436023677499274953;3.1872287656686184576 -1.2551217864422470338 3.4298805962867278119 -1.8651176514700620324 0.32863912378415455207 2.6611027141585452682 7.0375019028834930879 0.88737406224120518594 -5.6041188622470334835;1.1947510806820171858 -0.43601989137676783193 -10.209137286334744488 2.7938969739074059895 -1.0010728182351049664 1.661108370036888493 3.6301354563124408337 5.0522661266146560166 1.647157898850544866;0.30819740976182341541 1.5647843837338601958 1.0096199328087989144 -5.0089085803518678119 -0.28506672004244787422 -3.0471997033883995165 -0.46933863903448480581 -1.6456213295955970377 2.049008117269310425;-2.4002024369889305433 -2.621200281942934307 4.364169211339443244 -5.1181277193645664525 -0.70849827154431188614 -2.9429404557479341698 -2.1970359401517818299 -1.1449853791349595689 2.8771317690921911492];

% Layer 2
b2 = [0.42194276886582871011;-2.5425805251296247356;-0.97974560090775630883;1.1872694271836661262;-1.6347369800633706483;0.61679923895343868878;-0.00059227583459997763284;-1.4603212775691689629;1.5846725028370787225;-1.3858781583276751359;1.4633069042978394947;-1.0742857850645528561;-0.86290102988458028399;3.1426422360141157419;2.0481192499375469041;2.0947233203731108198;1.2184841267353998528;-0.22623440206727588042;-2.2297474448193068675;-0.54156697182879076635];
LW2_1 = [-0.48355914687193302104 0.59665599332616292561 -2.0097223134291342106 -0.57701940144902452712 -2.048796264127947353 1.552938128389728778 2.6803298345722859075 -1.8327216780654522754 5.0449777705592282473 -1.6474318264337972639 3.2695302828166523668 4.5893027135191815091 -1.79725996992396575 0.97851241160266677621 2.2627964274531477962 -1.5240837417491479577 0.091523388363950589075 -2.2384807441019956009 -0.88963679498355496822 -0.78253028919052525225;2.899287869016773378 -2.088059095251543873 -6.0820199297794603766 -2.7862873503675111841 -4.5646825029232758197 -3.0872642518783171006 -2.7438092513995733235 0.29386334512942119401 0.50133914930858702874 5.3794611448656111108 -0.2363556906648826561 -0.33552996049689970404 -0.84663072623478652368 0.94183381089968054578 1.5219168925328547815 2.0069610275123834775 0.28242047014049703746 1.3822639416108590815 0.25834903167903350285 -0.023464986342270979097;3.6796230413604269494 -1.3735919917478982555 -2.9649341617367652724 -3.1517869433042946525 -1.2392365512195937516 1.2314002930683634052 -2.8902038691620042243 2.6384851197597631867 -0.51673961910016974475 -4.2593711175981336936 -0.82252589023828304171 1.6036821815065336327 -0.37042417637806668296 2.4981525416691594543 -3.2426358623814630633 0.10875604124842530585 1.8469455032163279995 0.0033557931211772537052 -2.0047076009810376185 3.2242662301507323264;-2.5077692886415023921 0.56335084816350478043 0.46639499204498918727 0.45593620176547028366 -0.90414914384452782503 0.26061013056438631086 0.092087836788168467295 0.34532486159870007247 1.7631889277862287102 0.54603300230200746412 -0.66098934261219932651 -1.3239488538980777044 0.73181301521775299346 0.58132435164788798243 -0.70061742589536313286 1.1830087196248701975 1.2066967530556804711 -1.3683900543282654372 2.8313752305547819077 -1.8702823355946613937;0.87848699491630999336 -1.8269092730474727482 -4.5918597438228161423 0.11536024729249322318 -12.666142448440556478 -1.4025819240603059068 -12.067646054112104892 -1.3451038380716295872 1.6583042547730022509 9.4858235910206563091 -0.33318816285357888418 0.56902126953862985914 -12.573480131831693996 -1.5212285736379347334 -5.032005398760308168 9.5784764087306459857 7.4970807919777335826 0.60250982146828357955 1.3276261674216311981 -0.90082527843690751723;-0.0036434367502576644852 0.44548616797159928948 0.3938991975598509776 -5.7844316073920403198 -0.41058454644029457326 -2.2463182862215256286 5.575596704097250722 -1.5294334285217583425 0.9697409319659088256 1.7786867379161104274 1.5614975857991573172 -2.7932478411268415464 4.0310080736550855107 1.3992920269929793875 -1.1555639583789687475 -3.2927234624591412704 2.8388040608581719404 -0.41830533962331278852 -2.4552388916021445908 -0.057662816882137403474;-0.80223273838656306012 -0.21528346822899044333 -0.97605155270533972001 -0.19566275733465751663 3.5516499623662443064 2.0485637984155014024 2.5332476348223873508 0.89701812454047158418 2.1156882815287976207 1.0758070639228829446 -0.31919510922223837124 -1.326874872844597153 2.3690683503742984151 -0.90567853402743414559 0.030015128623949165199 -0.23938037296774458684 -0.13869281460176946519 -1.1852189100388113019 1.8594616388396068007 -0.09376640108200201551;-1.3815496884745717132 -1.2559960920275479168 -1.3818325995373601511 -1.3274872972879001587 0.878259343754857702 2.8026221897950716055 0.16375698780800088117 2.2581782233269009907 -2.9633920758799074946 -0.03900841244779814504 1.2971588065053705208 -0.98008179029218089884 2.6305789021891889945 -2.2857666324335101926 2.7721966646296332115 -1.1433733586428695972 6.1093222778850924115 -0.66178549966064814658 -1.3594815276929865799 -0.14806010687349463462;-1.7298635045240451369 1.5144199174434693767 0.57070204280728120683 -0.54271980315297541075 -0.16006541191787077016 -0.86111234952194226633 -0.084095146666473108432 -0.44234629523282698038 -1.0006601711533245069 -2.7565889060845081282 -0.17297491469657641505 -0.79590205505289690624 0.85744207521841608877 -3.7263806458316444115 -0.80155037826999864237 0.86683058028951465168 -0.14048651696801253697 1.913109219904343572 -1.0893800622962197533 0.12730902426138160366;-3.5157896358157496586 -1.0906071358891706868 2.9547961657995789331 3.6446127299673887201 12.494891738977306872 -0.88843691781231726168 10.941861709792894075 -0.69005210721598331247 -2.5019671628722033319 0.086417639992523456738 -0.42233557313893627105 0.89559688596525799387 8.6188507025953366991 4.953250793893836601 1.0523006309728928365 -7.2189457723165011416 -4.0488135334865145154 1.163760582292026502 -1.9123200557858994753 -0.26238806195103925312;1.3853650666742414188 1.3706547631324332848 -5.4299606908476540923 -4.428535433146903344 -4.1827747146851281812 5.5966783806276998448 -0.022282338950928702592 2.0104098956698526202 2.213548919417844818 -1.0386718444312224019 -0.46826762890742595902 -2.0885168223883132654 -2.6602497919238787816 -2.3974284198620008368 1.5431374323310098617 2.5029196565969131782 3.3958838999047724627 -3.0609196022107130197 -1.2797301746314289073 3.0615387727436407239;-1.2909169093296413156 -1.2122719914397375174 -0.29295784676171654493 -3.011656898627746326 -0.75555142805100428127 -3.6510627610637422791 -1.9794198421498310214 -2.5125530863064753362 -3.8655521046296339449 -0.96734954241306403411 2.2076778069557363438 -2.7081773763390390997 1.4483287341167441209 1.5445052688643108318 4.5679449435019243708 -4.581427453353668966 1.6941820138254182204 1.5137330157078421333 -3.2693078909535087107 -0.030921917014676881391;2.041446442985785481 -0.73179979369520087307 -2.5986889501822694193 3.5241804151561195724 0.98534921107071016255 1.1013253261694595508 1.2615688169699044163 -0.25978834542291212584 1.6915923385711888471 0.87129392461608412557 0.52684727510560869224 -0.57105510155356042912 -0.38401563982718539547 -1.4329011527893482647 -2.1622603032063429929 0.25775885729904796095 0.90316983454798027697 -1.5065453068343483967 -0.22921810031941841634 1.7099452566704329559;-3.9010803218872940334 2.7542331731450704346 11.188898031905360142 8.673117949617976663 15.98348132743980976 7.5491139653651089247 14.373685742887348127 -0.67471472208078298038 0.29143306610338537421 -11.982369041721563363 -0.0010572097371880041436 0.23432056221940297802 7.3886922395235785643 -2.652494374636141572 4.4833858878877883569 -9.290319561248335134 -3.1115419931587013913 -0.63081270212731588298 2.562892340166997851 -0.98581186917140828374;-0.14573347565680011551 1.8706442089752128854 -1.5306242610071740806 -0.054937391467267282508 -0.26140663541084263599 -1.6222159016501882522 1.0524150956588724792 -1.9744744031582626143 0.87959931921761902451 -1.2826073326136713249 -0.094224826011885004506 -0.047495415845742648686 1.2288038491501305227 1.5791432611416269527 -0.44208454476665182131 -0.69883236538619275535 0.15198289333023665137 2.0005117624592556602 1.6805721132745172763 1.551690916402759024;-0.85949068566952613324 2.1821462961197037878 8.2545133191919131121 0.18892299090769504311 7.697568168213565265 3.2412229585225871276 12.761327358123640607 0.3391262494487771173 1.1749279077654843917 -1.047542988095905736 -0.28585574039902017507 -0.25249380609462540592 11.48160631350340033 -0.52558809342705337109 -1.5612153925351899275 -5.3553859524212468202 -5.1738885250251787085 0.56053131220896101894 0.59283371316022515085 0.21480814907269385472;-1.1618476970697746431 1.5944143627675113617 8.3364413360720561741 7.5670719487288273797 12.411014930790578603 10.646932262653661994 12.283420406083964238 -0.72276427641743734576 1.7325035149225005426 -8.3297878043078519283 0.0066533714940277873667 0.15342459301880190248 11.352289833725095036 -2.8329007157114127757 2.0687703663841143786 -10.138302175876718891 -9.090616968216840732 1.0191504166104796703 0.82560652917207566492 0.61725317306203919543;0.46147186752023000578 -0.62136094564450161659 2.1093053199808817766 -1.1664341788281136214 -1.6837060220716313363 2.7252437049512847622 3.6640778796423583152 -0.70226396683579961344 1.6487987865017357247 1.9040099024945928985 0.050572531620821987997 1.3171422846171116916 -1.4441227347627167976 -1.2156908202596690138 0.54162509089157684361 -0.63372165137764313592 0.14693332757798743815 0.73915709329633516589 0.6099678188441016724 2.5397511747606484889;2.1901541534115063214 -2.1548225083710925709 -1.4390102369367376856 1.0922346812099164026 0.35484643893792133795 3.9678618376108354404 -1.0995239818029529655 -2.7566869413922674426 -4.0090119021144330347 1.0272395904428430757 0.30684434491159934266 -2.003509465298383585 -0.92860777113111125924 -3.2910037858901914909 3.2057627564724460179 -1.147237035899258295 2.7957605736727630941 -5.2530254961764404342 -1.727893547995839052 2.019245384231341145;0.64070569818417011376 0.18987082665919702285 -0.52980157603161215363 1.859483497292500731 -0.53084947137411997442 0.48278206563674341822 0.79378732307555899261 0.26378193115046499884 -0.65006724089238898667 0.99520623333963587065 -0.56601084382331967593 -1.2586946641779876987 -1.2074291782644694937 -2.3142018852652261884 0.64613668400004165004 0.68454532442771709455 0.86646095024743174928 0.41723757027015767607 -0.70854788971019089239 -0.24072423663052541776];

% Layer 3
b3 = [-2.066086665537734568;-1.5172128533829649655;3.5694267526529892542;-1.7766947633465028922;2.9434060729535134193;-0.90123861652676717782;-2.1535417619812586842;3.0750514568163329621;1.9682555951428022389;-2.3298556232029294932;-0.60203484746166580077;-0.34059668497933986986;-1.3608577767965623906;-4.3679904964530793521;-1.3027043477499919977;0.33388095415444613012;1.1364690161831059179;3.2785914624574479248;0.7489991659634717136;-0.42191529890000989411];
LW3_2 = [0.51673818664721526961 -1.8673130187991575646 0.15728484501274855867 -0.51095613614648638379 -2.9536274828289657002 1.0403717570581132446 1.3259667023510788297 1.1050733146033220322 0.17908117736330184111 2.6615590251036556069 -0.53563784658266688776 -2.3764748372045176872 1.4328408902509681688 0.75815285673404630984 -1.6540601400223648998 3.4855314255306142357 -2.0053553130578674057 -4.0441942590557067305 -0.74579716651302774277 1.8574580198934977915;0.12301982558698094927 -3.0409017066453083444 -1.148081865286514569 -2.9642232607186436155 -3.9956988675329707661 -2.4373178259866672413 -4.4242015532453864424 3.5303020251829932974 0.15518562935560473171 -2.1720099403638029045 2.7851781779705251374 1.2797274957314535015 -2.2462461357378971094 2.8946801320818176251 -1.327825880923494628 0.54386298385274545186 4.9011515932913036764 -2.7234731300454684266 0.57174076835656939544 1.1839931943009109894;-1.6147500431439840707 -0.73798743753558793124 -0.15221186089059007829 0.99350639996898826301 3.9137427278502414651 -0.33183154410463583384 -1.9083305198635609479 -1.2524204807760397351 -2.0505437058930300331 1.5408058749383910513 -2.5311928622403083722 8.0293984179095811982 -0.659413388418857771 0.31660595861518925354 -0.32613357085496308407 2.8355322401041638258 1.9218792035777398919 3.4055598064468695085 1.314294451770744443 -4.8238472970067522994;-1.1537490664986258526 3.4912016694644445458 -1.9037338498553741939 1.205645101046212142 11.825200599482538877 -3.8275339101417507059 -2.0745565597659627599 -0.85737425193739380536 -0.038267620147702845201 -6.7969137458558073206 -0.32688765338138131566 -5.5924925012267419078 1.4582463855065159741 -11.14557746437245811 -4.8203485693661276557 -13.37268178191306589 -12.389319456707047706 1.0485571629024652562 1.6022574243266469729 1.7543230902506514735;-2.6895388440421945653 -0.065767659349553878045 2.3985973139270506671 2.2373869631749752074 5.9249315103315742803 -0.40209263370687559069 -1.6354496064860672977 0.0089200992781808454563 -1.7466590345482455593 5.840038445322832672 8.0516592167480798281 -1.3616343619313420188 1.747347788562099602 0.13788646897039222305 3.2188263116857700474 -6.6658253058685534853 -2.2433561784300373176 1.1272948760067296181 -1.985139324289798779 -2.7027987663644021943;-0.51233757855552397587 0.38999246305076601393 1.3825937245986474888 -0.53540315151995221399 2.1965323606105644494 -0.30178573385105716964 0.44888956938094659588 0.029225028878165068558 -0.86028785747165570363 0.40260305713414407114 -0.14669713399947523214 0.7797258890467121395 0.60623866208035270819 -0.23822104553218836909 -4.4531309486443300116 1.0308944748704493843 0.48568995196885461629 3.2721322931293785885 1.0847577074104364225 2.2070352059469597883;1.2492127682769267327 3.9130338408838483133 1.9814833578592825347 -0.948425349955721253 11.198756766946452501 0.1537825594454121092 -1.3500454784808497699 2.0294068534133296033 0.93062884815801327765 -10.757008344254508359 0.1937340446544325856 4.5114736887615674021 -0.0070799115270969515193 -14.239445497769571247 2.6208245467330950618 -8.256086195516271431 -13.058950073500856348 2.0862694087688464784 -2.4972369956880475783 0.93760306786195557471;0.76201158067626240111 -2.7438933349267378148 1.1129466827287393116 4.9413716194777341784 -11.311525397267052639 0.56610151177759038266 7.8800069943102055703 -3.1806283802438639619 2.198136879531324972 5.2678657688039898233 1.1145191122730229161 4.4983804512013687571 -1.0200687925768234798 12.875609466555914651 1.1370523497284925618 11.212977122831182086 12.054957586786121837 0.33925412776364299861 -1.2641812561355207922 -0.96296200724887859312;0.63110624303596374318 5.6913741204514574079 2.6226665928199675015 1.9219058724402175997 5.6446164374447143075 1.5591952729440909931 1.8373491149077725293 1.0140797880924703467 2.9198426230969474204 -9.4190026838427449718 5.5383581429659383133 0.50422155524176748287 -3.6616858187031842142 -8.1728599394475001105 0.44104990953876371806 -3.0725152068573802211 -7.0688608413980578149 2.0858940491561925867 1.7233552849801605511 -0.8293142968164761708;1.8560948531061702838 3.8651489915043315548 -3.3685894792941764031 -1.8447784022951345673 2.3140802967797178269 -3.4967624762737026245 5.7977407390394493092 -0.037123384096647990549 -1.70544634408900464 0.90173566761733858765 0.64192604137530939745 -1.5665848042577719124 -2.3534903642578393068 2.6847603557836272614 -0.23703673331983168837 4.8451977378032395904 3.0767083928238512236 -2.4801470805223284621 -1.4432149580556372648 1.4170060610130841283;-1.2393890626868189209 -2.3142296508353887852 -5.3715144176385862806 -1.2161689248277223196 -8.7055826184993048145 -5.6977602519523076197 1.825373056621547585 -0.045728942774982211938 -0.20749402019211729553 4.9805527639901940873 -3.1524141046847562464 -3.9562908527985611862 1.5393655922815081549 7.1946406244625267234 -3.5610220300269825877 -2.5746047015802449032 2.5880537248456052524 -3.6912539499272631893 0.57885273324821651109 -0.10962031619569270746;-1.3936831755018117551 3.9901049375349710857 0.95376842275166107132 0.44346497826799613495 -3.0242259399775015538 3.0901942917596190163 13.044326236854850265 -8.1527339189635874561 0.62772002145528926764 4.2452124045703856225 -8.8717583692193890954 -3.3901011457671246241 5.6462622634410584155 2.8722160850066469351 0.4990466377712294288 5.9601714682519375543 0.22841627172984443894 -0.82644435406782945641 -5.3665391308759335942 -0.55564836155606212031;0.61433546505225666845 -2.002937927104641247 -0.32947390250696995118 -1.111907493759326071 5.245338384025711953 2.3732286417323980032 -0.88845960765156328787 1.5680925724915297792 -1.8703505824507453692 2.7119956737690551485 0.4262475778787195857 -3.5510488190422968557 3.5307079261543070636 -3.7143096987258572561 0.023636263430653951106 -1.632605935758753013 0.78467635377605937652 -1.7940441218541234303 -1.565221439143525739 -0.51725446859054335924;0.88194512428451332653 -0.076226452486634066474 -4.7696090204009173874 -2.6271895281376655973 3.4396253775155214427 1.1225111007860901768 1.2118908474504939132 -3.236674546181388834 -3.7617222600801549781 -2.695397030082791634 0.018987990659528705684 0.43734673108068028435 -1.5699294883252721267 -3.3128523588208835804 0.83165583754315175469 -4.8155796044910896825 -1.3493054028650801612 6.414670865814997569 -0.86031126739456531549 -0.84313182984533774356;4.4927191123450622712 6.1478872228204464179 -0.93790135450096545622 0.52420181262687215451 -4.7140058327317619913 -3.8957276560481171046 5.1671453951436072671 2.5453295376439295516 0.85317377040106401331 -3.5912171782826733946 -0.64636240787501975102 5.1426265712572831745 1.1376341238310492265 -0.98166521439474452304 -0.57862201233687959867 -1.0888858218179777726 0.3155394440432314207 -3.8767178127534127619 0.2823464887582042282 -0.011899807651950670626;2.3169584617883787203 -3.7517214780395020668 -2.440279886005256138 0.15898919616705015079 4.3530682362147476994 2.810183033801883834 -2.9388186311651813831 3.486052063851640348 -3.3334397296426727664 -3.9580608046912120201 2.0977882170104940052 1.1419179244685058183 1.3601096074342866604 6.4537992530187642259 -1.5111417071918251676 1.9783622175994350911 6.0914600950951411917 -6.5490647129097068202 -1.1157545492419440603 -1.8587201119776128877;3.7212924104612663534 -1.2849598155207673233 -1.079718526475539786 0.63639844663579359096 -1.1726570372964482125 3.0144350783117355164 -4.1362341598458307601 2.9352230576301567844 -1.7197016959097730648 0.77579325559284639802 -0.16162362254394435634 1.1887190961280751367 1.9078999923127677452 2.8672180700262610564 0.033892399793250184425 3.4617935337457050871 0.972183172706676757 0.10844421694944657297 3.3706613072553399668 2.7236072381939009368;-0.74664608967841605836 -5.5185927973129960122 -1.269151085375429977 4.1381462122532743919 -12.768402867562828717 -0.027633582222152598684 1.8303906181527609398 1.5002915551612903133 -1.5216108915173403027 12.206456188020919029 0.066784251043959727556 -1.5227294483236983869 1.5844713326710933021 15.276026359156487544 -1.6029057636529331354 8.9408076828255076407 12.940977633194313157 -2.485683432815597893 -0.082927974204531115787 -1.6028901043103620516;2.0549789709684924688 4.5989486591681254524 2.3707476713039610239 -1.4544046453496450866 -5.1066581448558219236 3.2711119234010661572 2.9126172817773889889 -1.1133162198466279857 0.85119142772506639627 -0.48741390086010505378 5.5785745499741414832 2.8382024200254276636 -1.369829729984709088 7.511090748865367317 -3.5132748724981519572 2.7856510658026412131 1.2488446329111813071 -1.6441167994433236732 -1.3304110960208634928 6.6462597059212242812;0.80726723583537163265 -2.5720848563649183482 -0.077892437953963680752 -1.3766725601759144393 2.1769163260331145793 -1.4289543742464307918 -0.93799443929466574943 -3.8580779220548460096 -2.6670819711881996739 4.9105192524968099832 1.3034393363014287193 2.3344662473552935111 2.4425463117569772287 1.6941434276480296095 -0.052598339643216848738 -4.0491106668691383419 -4.0132101222268206087 -3.2171618911671471253 -3.7053232479239515129 1.227900169089889193];

% Layer 4
b4 = [1.5766067103781340464;-1.1468878060658198592;6.0923654441967931561;-5.5820956769221012905;-1.8606977986915249623;0.61658773309144521146];
LW4_3 = [-2.1778868466282186311 -15.406721614492184358 -3.5592666565327091277 3.7630978736606377488 4.1364605712765074585 9.6728813508590292258 1.1861750507182737824 -1.3828773248787167294 -2.6202288975280239036 -6.2861166376258248434 9.8358084100207658906 -7.9001666568471380359 -7.2952154737700194431 5.617379795569076073 2.9711348234907202226 9.4073394396427296726 -3.7938967978101962863 -8.3586660957497915803 -10.969245519855103765 1.8767468090872876374;-5.045244148596885303 12.928383408226766349 -5.8043270557869366399 12.313058766538754085 1.5111289277574841972 -7.7874723117994406607 8.2563709833734133525 -3.0978433663999829228 -1.0601394759818314473 6.2730197477325173594 1.5394581495363461876 8.2927528974093540626 -5.7978982477290683661 -6.5626335891587084248 -3.7865875302421549975 -0.94336069795730592702 -9.1158874950932222703 1.4275733418168159439 6.9619313288885749103 6.1958731086450722358;-3.3507452851748698031 -1.692599495049820435 10.398908147335385266 -12.259968420955514645 2.4126886063308861097 -2.7547203494250420697 1.9315748902102596318 -8.9722908516604515938 12.941486142436263052 3.5362643335360210983 -8.9106096060141055659 -0.032652852213248456659 -7.3338308203271447283 -4.1376509486252377457 -1.9957575087454593188 -1.7030541126857028367 6.09133656895855502 -4.0429617989885038298 1.4577902977848931076 -10.334000432542783443;7.7382460147633480574 -1.2962459968739687977 -0.46130951229283040371 -13.485353976113723107 -9.3440271776469483456 1.6676738907902832754 -19.720345033338208651 22.766175848840454421 -15.884899771830077952 0.14803434815493121679 -0.20567257280928105678 0.72025924908926042267 17.041853101477798305 3.0561986582871050189 2.3071101925223871376 -2.3868925850746935957 3.1829803373213994 20.327009821143189328 -0.5688203746820672535 -2.0724985387386665181;0.12376112759619216364 1.5883205270828126832 1.3250610693674200746 11.841864441907278049 0.5365097064228774304 0.67398026236423813629 6.7247005963204955492 -8.8139154388925486927 7.6080387875133732578 -1.8952208162522736767 -2.6899304827183891931 0.49934775603043013437 4.2129220685954100745 2.3913319245344624164 -2.3503620666908324743 -5.1654752729041018 1.45311501802767018 -10.372068587394336348 -0.14075806949694943948 4.0319672738810128365;2.7317943688126256063 3.9572790791329999216 -1.7315584790860423237 -1.9599187713684222967 0.85268717104110169913 -1.498488351210748748 1.8506664630336873145 -0.2410735866207227851 -0.81375713783946712621 -1.9626472684806379743 0.48403564166167217797 -1.4351054506474973937 -0.65812397688662371831 -0.52581123916859118239 2.8262012280495754091 0.95060497051891212905 2.4835847236281058947 0.83550907013491004793 3.4140167832089889366 -0.017601228482189115038];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);

% Layer 4
a4 = softmax_apply(repmat(b4,1,Q) + LW4_3*a3);

% Output 1
y1 = a4;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
